<!DOCTYPE html>
<html lang="en">
    <head>
        <title>The Discouraged Sector</title>
        <meta http-equiv="Content-Type" content="text/html">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">
        <meta name="author" content="aris">
        <style>

            body{
                background-color: rgb(40, 40, 40);
                color: white;
            }

            .heading {
                height: 100vh;
            }


            .center-content{
                display: flex;
                justify-content: center;
                align-items: center;
                flex-direction: column;
            }

            a{
                color: hotpink;
                font-weight: bold;
            }


            h1{
                font-family: "Lucida Console", "Courier New", monospace;
                text-align: center;
                font-size: 300%;
                margin: 0;
            }


            .trans1{
                background-image: linear-gradient(rgb(40, 40, 40), rgb(85, 55, 0));
                height: 50vh;
            }

            .trans2{
                background-image: linear-gradient(rgb(85, 55, 0), rgb(131, 85, 0));
                height: 50vh;
            }

            .trans3{
                background-image: linear-gradient(rgb(131, 85, 0), rgb(155, 106, 0));
                height: 50vh;
            }

            .trans4{
                background-image: linear-gradient(rgb(155, 106, 0), rgb(204, 139, 0));
                height: 100vh;
            }
            

            .floor1{
                background-color: rgb(85, 55, 0);
                height: 600vh;
            }

            .floor2{
                background-color: rgb(131, 85, 0);
                height: 600vh;
            }

            .floor3{
                background-color: rgb(155, 106, 0);
                height: 500vh;
                display: flex;
                justify-content: center;
                justify-items: center;
                align-items: center;
            }

            .floor-text{
                font-family: Arial, Helvetica, sans-serif;
                text-align: center;
                font-size: x-large;
                padding: 5px;
                z-index: 2;
                transition: opacity .5s ease-in-out;
            }

            .last-text{
                height: 100vh;
            }

            .treasure{
                height: 100vh;
                background-color: rgb(204, 139, 0);

            }

            .sign{
                position: absolute;
                right: 10px;
                bottom: 10px;
                width: 200px;
                image-rendering: crisp-edges;
            }

            .chest {
                filter: drop-shadow(8px 8px 10px rgba(0, 0, 0, 0.4));
            }

            .key{
                position: relative;
                bottom: 0px;
            }            
            
            .final-popup{
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                height: 100%;
                width: 100%;
                position: fixed;
                z-index: 3;
                top: 0;
                left: 0;
                background-color: rgb(0,0,0);
                background-color: rgba(0,0,0, 0.5);
                overflow-x: hidden;
                transition: 0.8s;
                transform: scale(0);
            }

            .button {
                display: inline-block;
                padding: 15px 25px;
                font-size: 24px;
                cursor: pointer;
                text-align: center;
                text-decoration: none;
                outline: none;
                color: #fff;
                background-color: #2c8dce;
                border: none;
                border-radius: 15px;
                box-shadow: 0 9px #327781;
            }

            .button:hover {background-color: #277bb3}

            .button:active {
                background-color: #2370a3;
                box-shadow: 0 5px #286068;
                transform: translateY(4px);
            }


            @media screen and (max-width: 1024px) {
                
                .final-img{
                    transform: scale(0.8);
                }

            }

            @keyframes shake {
                0%   {rotate: 0;}
                25%  {rotate: -10deg;}
                50%  {rotate: 10deg;}
                100% {rotate: 0;}
            }
            .shake-anim{
                animation: shake 0.5s 1;
            }

            @keyframes shake-and-fall {
                0%   {rotate: 0;}
                5%  {rotate: -10deg;}
                10%  {rotate: 10deg;}
                15% {rotate: 0; bottom: 0px; opacity: 100%;}
                80% {opacity: 0%;}
                100% {bottom: -2000px; opacity: 0%;}
            }
            .shake-and-fall-anim{
                animation-name: shake-and-fall;
                animation-duration: 3s;
                animation-fill-mode: both;
            }

            @keyframes chest-open {
                0%   {filter: brightness(1) invert(0); opacity: 100%; transform: scale(1);}
                60% {filter: brightness(0) invert(1);}
                100% {opacity: 0%; transform: scale(2); filter: brightness(0) invert(1);}
            }
            .chest-open-anim{
                animation-name: chest-open;
                animation-duration: 3s;
                animation-fill-mode: both;
            }


        </style>

    </head>

    <body>
        <div class="final-popup" id="fin">
            <img class="final-img" alt="the secret of the site" src="assets/white-shirt-with-text.png" height="500vh">
            <p class="floor-text">
                You did it..
                Now get away!!
                <br>
                <br>
                <br>
                <a href="/scenes/48/">Pumice & Hummus</a> 
                <br>
                <a href="/scenes/47/">Wetwater Lake</a>
                <br>
                <br>
                <a href="/scenes/65/">The Forbidden Sector</a>

            </p>
        </div>


        <div class="heading center-content">
            <h1>403.3 Discuraged</h1>
        </div>
        
        <div class="trans1"></div>

        <div class="floor1 center-content">
            <img alt="bone" src="assets/pebble1.png" style="position: absolute; left: 10vw; top: 400vh; filter: drop-shadow(4px 4px 5px rgba(0, 0, 0, 0.4));">
            
            <p class="floor-text" id="1">
                Can't you read, you scallywag? You're not supposed to be here.
                <br>
                Just move on to <a href="/scenes/48/">Pumice & Hummus</a> or <a href="/scenes/47/">Wetwater Lake</a>.
            </p>
            <img alt="The key" class="key" id="key" width="10%" src="assets/key.png" hidden>
            
            <img alt="bone" src="assets/pebble2.png" style="position: absolute; right: 10vw; top: 600vh; filter: drop-shadow(4px 4px 5px rgba(0, 0, 0, 0.4));">

        </div>
        
        <div class="trans2"></div>
        
        <div class="floor2 center-content">
            <img alt="bone" src="assets/bone.png" style="rotate: 60deg; position: absolute; left: 10vw; top: 1000vh; filter: drop-shadow(4px 4px 5px rgba(0, 0, 0, 0.4));">
            <img alt="rock" src="assets/rock1.png" style="rotate: 10deg; position: absolute; right: 5vw; top: 1100vh; filter: drop-shadow(4px 4px 5px rgba(0, 0, 0, 0.4));">
            <p class="floor-text" id="2"> 
                What? You think there be somethin' shiny at the bottom of the page?
                <br>
                No way, matey. You're seein' things, just go back <a href="#1">up</a> and chose a different path.
            </p>
            <img alt="rock" src="assets/rock2.png" style="rotate: 10deg; position: absolute; left: 7vw; top: 1200vh; filter: drop-shadow(4px 4px 5px rgba(0, 0, 0, 0.4));">
            <img alt="bone" src="assets/bone2.png" style="rotate: 25deg; position: absolute; right: 15vw; top: 1300vh; filter: drop-shadow(4px 4px 5px rgba(0, 0, 0, 0.4));">
        </div>

        <div class="trans3"></div>

        <div class="floor3 center-content" id="cat-floor">
            <div id="props3">
                <img alt="bone" src="assets/bone.png" style="rotate: 20deg; position: absolute; left: 20vw; top: 1600vh; filter: drop-shadow(4px 4px 5px rgba(0, 0, 0, 0.4));">
                <img alt="bone" src="assets/bone2.png" style="rotate: 25deg; position: absolute; right: 5vw; top: 1700vh; filter: drop-shadow(4px 4px 5px rgba(0, 0, 0, 0.4));">
                <img alt="bone" src="assets/bone.png" style="rotate: 40deg; position: absolute; right: 25vw; top: 1780vh; filter: drop-shadow(4px 4px 5px rgba(0, 0, 0, 0.4));">
                <img alt="bone" src="assets/bone2.png" style="rotate: -5deg; position: absolute; left: 30vw; top: 1900vh; filter: drop-shadow(4px 4px 5px rgba(0, 0, 0, 0.4));">
            </div>

            <p class="floor-text last-text" id="3">
            You're still here?
            <br>
            Well, I'm not supposed to tell ya, but there is a secret path.
            <br>
            You could go to <a href="/scenes/65/">The Forbidden Sector</a>. But you didn't hear it from me, aye?
            </p>

            <div style=" display: none; width: 100%; justify-content: center; align-items: center;" id="cat-box">
                <!-- Jellie interaction -->
                <div style="display: flex; flex-direction: column; justify-content: center; align-items: center; width: 50vw;">
                    <p class="floor-text" id="jellie-text">
                       So you are still here?
                    </p>
                    <button class="floor-text button" id="jellie-btn">
                        Who are you?
                    </button>
                </div>
                <img alt="minecraft cat" src="assets/JellieCat.png" style="margin: 50px; transition: opacity .5s ease-in-out;" width="300vh">
            </div>

            <p class="floor-text" id="4">
                No no no. Go back, go away. It's my treasure, not yours!
            </p>

        </div>

        <div id="final">
            <div class="trans4"></div>


            <div class="treasure center-content" >
                <p class="floor-text" id="5">
                    Ha, tricked ya.
                    <br>
                    You'll never find the key.
                </p>
                <img alt="The treasure" class="shake-anim chest" id="chest" width="50%" src="assets/treasure-chest.png">
            </div>
        </div>

        <div class="sign-container">
            <img alt="Handwritten 'Keep out' sign" class="sign" src="assets/keep_out.png"/>
        </div>



        <script>

            var chest = document.getElementById("chest");
            var key = document.getElementById("key");
            var jellieBtn = document.getElementById("jellie-btn");
            var jellieText = document.getElementById("jellie-text");
            var jellieFloor = document.getElementById("cat-floor");
            var jellieBox = document.getElementById("cat-box");
            var finalBox = document.getElementById("final");
            var text1 = document.getElementById("1");
            var text2 = document.getElementById("2");
            var text3 = document.getElementById("3");
            var props3 = document.getElementById("props3");
            var text4 = document.getElementById("4");
            var text5 = document.getElementById("5");

            var key_collected = false;

            const jellie_talk = [["I am the guard of the treasure.", "Ok. Can I have it?"], 
                                ["You came all this way just for this?", "Yes, the chest is shiny, I want it!"],
                                ["Alright you ignored all the signs so I guess I can't do anything to get you to go away..", "Right, now let me pass!"],
                                ["But let me tell ya <a href='/scenes/65/''>The Forbidden Sector</a> is a place you don't want to miss.", "I don't care, now let me pass!"],
                                ["Yes yes, but be warned the secret is not what it seems to be.", "What does that even mean?"],
                                ["You'll find that out IF you continue to the treasure.<br>But if ye don't wana risk it just go to <a href='/scenes/47/'>Wetwater Lake</a>", "Stop witht the distractions and let me pass!!"],
                                ["Alright but don't tell me I didn't warn ya.<br>Goodbye.", "Bye, I guess?"]
                                ]
            var jellie_talk_count = 0

            jellieBtn.addEventListener("click", function(e){
                e.preventDefault();
                
                if(jellie_talk_count >= jellie_talk.length){
                    // final phase
                    jellieBox.style.display = "none";
                    finalBox.style.display = "block";
                    jellieFloor.style.height = "500vh";
                    props3.style.display = "block";
                    return;
                }
                
                
                jellieText.style.opacity = 0;
                jellieBtn.style.opacity = 0;
                
                setTimeout(function(){ 
                    jellieText.innerHTML = jellie_talk[jellie_talk_count][0];
                    jellieBtn.innerHTML = jellie_talk[jellie_talk_count][1];

                    jellieText.style.opacity = 1;
                    jellieBtn.style.opacity = 1;
                    jellie_talk_count += 1;
                },500);



            });
            chest.addEventListener("click", function(e){
                e.preventDefault();
                if(key_collected){
                    chest.classList.add("chest-open-anim");
                    // open popup
                    document.getElementById("fin").style.transform = "scale(1)";
                }
                else{
                    chest.classList.remove("shake-anim");

                    void chest.offsetWidth;

                    chest.classList.add("shake-anim");
                }
                
            }, false);


            key.addEventListener("click", function(e){
                e.preventDefault();

                key.classList.add("shake-and-fall-anim");

                // phase 3
                key_collected = true;

                text2.innerText = "...";
                text3.remove();
                text4.innerText = "";
                text5.innerText = "";

                jellieBox.style.display = "flex";
                jellieBox.style.height = "100%";
                finalBox.style.display = "none";
                jellieFloor.style.height = "100vh";
                props3.style.display = "none";

                
            }, false);

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                    
                    // phase 2

                    text1.hidden = true
                    key.hidden = false

                    text2.innerText = "If you can read this.. STOP!"

                    text3.innerHTML = `
                        You could visit all these wonderfull places:
                        <br>
                        <a href="/scenes/48/">Pumice & Hummus</a>, <a href="/scenes/47/">Wetwater Lake</a>
                        <br>
                        or even <a href="/scenes/65/">The Forbidden Sector</a>
                        <br>
                        Don't they sound like fun?
                    `
                    text4.innerText = "Stop searching. Ya won't find it!"

                    observer.unobserve(chest); 
                    }
                });
            });

            observer.observe(chest);


        </script>
    </body> 
</html>